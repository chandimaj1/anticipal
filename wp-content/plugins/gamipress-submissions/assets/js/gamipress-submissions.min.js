(function($){$('body').on('click','.gamipress-submissions-button',function(e){e.preventDefault();var $this=$(this);if($this.prop('disabled')){return!1}
var form=$this.closest('.gamipress-submissions-form');var spinner=form.find('.gamipress-spinner');var post_id=form.data('id');var notes_wrap=form.find('.gamipress-submissions-notes-wrap');if(form.find('.gamipress-submissions-form-response').length===0){form.append('<div class="gamipress-submissions-form-response gamipress-notice" style="display: none;"></div>')}
var response_wrap=form.find('.gamipress-submissions-form-response');if(notes_wrap.length){if(notes_wrap.attr('style')==='display:none;'||notes_wrap.attr('style')==='display: none;'){notes_wrap.slideDown('fast');return!1}
var notes=form.find('.gamipress-submissions-notes').val();if(notes.length===0){response_wrap.addClass('gamipress-notice-error');response_wrap.html(gamipress_submissions.notes_error);response_wrap.slideDown('fast');return!1}}
response_wrap.slideUp('fast');response_wrap.removeClass('gamipress-notice-error');response_wrap.html('');$this.prop('disabled',!0);spinner.show();$.ajax({url:gamipress_submissions.ajaxurl,method:'POST',dataType:'json',data:{action:'gamipress_submissions_process_submission',nonce:gamipress_submissions.nonce,post_id:post_id,notes:(notes_wrap.length?notes:'')},success:function(response){response_wrap.addClass('gamipress-notice-'+(response.success===!0?'success':'error'));response_wrap.html(response.data.message);response_wrap.slideDown();spinner.hide();if(response.success===!0){$this.slideUp('fast');if(notes_wrap.length){notes_wrap.slideUp('fast')}}else{$this.prop('disabled',!1)}}})})})(jQuery)